<!DOCTYPE html>
<html>
  <body>
    <h2>User Information</h2>
    <label for="userId">User ID:</label>
    <input type="text" id="userId" name="userId" placeholder="Enter User ID">
    <button id="getUserButton">Get User</button>
    <div id="userInfo"></div>

    <h2>Delete User</h2>
    <label for="deleteUserId">User ID:</label>
    <input type="text" id="deleteUserId" name="deleteUserId" placeholder="Enter User ID">
    <button id="deleteUserButton">Delete User</button>
    <div id="deleteStatus"></div>

    <h2>Update User's Name</h2>
    <label for="updateNameUserId">User ID:</label>
    <input type="text" id="updateNameUserId" name="updateNameUserId" placeholder="Enter User ID">
    <label for="newName">New Name:</label>
    <input type="text" id="newName" name="newName" placeholder="Enter New Name">
    <button id="updateNameButton">Update Name</button>
    <div id="updateNameStatus"></div>

    <h2>Update User's Avatar</h2>
    <label for="updateAvatarUserId">User ID:</label>
    <input type="text" id="updateAvatarUserId" name="updateAvatarUserId" placeholder="Enter User ID">
    <label for="newAvatar">New Avatar:</label>
    <input type="file" id="newAvatar" name="newAvatar">
    <button id="updateAvatarButton">Update Avatar</button>
    <div id="updateAvatarStatus"></div>

    <script>
      function displayUserInformation(user) {
        const userInfoDiv = document.getElementById('userInfo');
        userInfoDiv.innerHTML = `
          <p>ID: ${user.id}</p>
          <p>Name: ${user.name}</p>
          <p>Status: ${user.status}</p>
          <p>Is Authenticated: ${user.is_auth}</p>
          <p>Has 2FA: ${user.has_2fa}</p>
          <p>Created At: ${user.created_at}</p>
          <p>Last Updated At: ${user.last_updated_at}</p>
          <img src="${user.avatar}" alt="Avatar" />
        `;
      }

      document.getElementById('getUserButton').addEventListener('click', function () {
        const userId = document.getElementById('userId').value;
        fetch(`http://localhost:3000/users/${userId}`)
          .then(response => response.json())
          .then(data => {
            displayUserInformation(data);
          })
          .catch(error => {
            console.error('Error:', error);
          });
      });

      document.getElementById('deleteUserButton').addEventListener('click', function () {
        const deleteUserId = document.getElementById('deleteUserId').value;
        fetch(`http://localhost:3000/users/${deleteUserId}/delete`, {
          method: 'DELETE',
        })
          .then(response => {
            if (response.ok) {
              const deleteStatusDiv = document.getElementById('deleteStatus');
              deleteStatusDiv.textContent = 'User deleted successfully.';
              // Clear user information after deletion
              const userInfoDiv = document.getElementById('userInfo');
              userInfoDiv.innerHTML = '';
            } else {
              throw new Error('User deletion failed.');
            }
          })
          .then(() => {
            // Clear input field after deletion
            document.getElementById('deleteUserId').value = '';
          })
          .catch(error => {
            const deleteStatusDiv = document.getElementById('deleteStatus');
            deleteStatusDiv.textContent = 'An error occurred while deleting the user.';
            console.error('Error:', error);
          });
      });

      document.getElementById('updateNameButton').addEventListener('click', function () {
        const updateNameUserId = document.getElementById('updateNameUserId').value;
        const newName = document.getElementById('newName').value;

        fetch(`http://localhost:3000/users/${updateNameUserId}/edit/name`, {
          method: 'PATCH',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            name: newName,
          }),
        })
          .then(response => {
            if (response.ok) {
              const updateNameStatusDiv = document.getElementById('updateNameStatus');
              updateNameStatusDiv.textContent = 'User name updated successfully.';
            } else {
              throw new Error('User name update failed.');
            }
          })
          .then(() => {
            // Clear input fields after update
            document.getElementById('updateNameUserId').value = '';
            document.getElementById('newName').value = '';
          })
          .catch(error => {
            const updateNameStatusDiv = document.getElementById('updateNameStatus');
            updateNameStatusDiv.textContent = 'An error occurred while updating the user name.';
            console.error('Error:', error);
          });
      });

      document.getElementById('updateAvatarButton').addEventListener('click', function () {
        const updateAvatarUserId = document.getElementById('updateAvatarUserId').value;
        const newAvatar = document.getElementById('newAvatar').files[0];

        const formData = new FormData();
        formData.append('avatar', newAvatar);
        console.log(newAvatar)

      });
    </script>
  </body>
</html>
